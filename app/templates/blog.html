<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <meta charset="utf-8">
    <title>QuantuMoonLight</title>
    <link rel="icon" href="../static/images/logos/logo.ico">
    <!-- Stylesheets -->
    <link href="../static/styles/css/revolution-slider.css" rel="stylesheet">
    <link href="../static/styles/css/blog.css" rel="stylesheet">
    <!-- Responsive -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <link href="../static/styles/css/responsive.css" rel="stylesheet">
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
    <!--[if lt IE 9]>
    <script src="../../static/js/respond.js"></script>
    <script src="../static/js/script.js"></script><![endif]-->

</head>
<body>
<script src="https://kit.fontawesome.com/b0f51da084.js" crossorigin="anonymous"></script>
{% extends "base.html" %}
{% block content %}

<div align="center">
    <h1 id="blog_title">QUANTUM COMMUNITY</h1>
</div>

<br>
<div class="create_post">
    <h5 id="username">{{current_user.username}}</h5>
    <form action="{{url_for("add")}}">
    <button class="btn" type="submit">Create New Post</button>
    </form>
</div>

{% for Article in posts %}
{% if Article.authorized %}
<br>
<div class="post-preview">
    <p class="post-meta">Posted by {{ Article.author }} on {{ Article.data.strftime('%B %d, %Y') }}</p>

    <a href="{{ url_for('post', post_id=Article.id) }}">
        <h2 class="post-title">
            {{ Article.title }}
        </h2>
    </a>
    <!--<button onclick="Toggle1()" id="btnh1" class="btn-like" ><i class="fa-solid fa-heart"></i>-->
    {% if current_user.is_authenticated %}
     {% if current_user.has_liked_post(Article)  %}
    <Button id={{Article.id}} onclick="Toggle1({{Article.id}})" class="btn-like" style="color:red"><i class="fa-solid fa-rocket" ></i>
    </Button>
    {{ Article.likes.count()}}
     {% else %}
    <Button id={{Article.id}} onclick="Toggle1({{Article.id}})" class="btn-like" style="color:grey"><i class="fa-solid fa-rocket"></i>
    </Button>
    {{ Article.likes.count()}}
    {% endif %}
     {% else %}
    <Button id={{Article.id}} onclick=ShowMessage() class="btn-like" style="color:grey"><i class="fa-solid fa-rocket"></i>
    </Button>
   {{ Article.likes.count()}}
    {% endif %}
</div>
<script>


    function Toggle1(intValue) {
        var btnvar1 = document.getElementById(intValue);
        if (btnvar1.style.color === "red") {
            btnvar1.style.color = "grey"
            $.ajax({
                type: 'GET',
                url: "{{url_for("dislike")}}",
                data: {'data': JSON.stringify(intValue)},
                contentType: "application/json",
                dataType: 'json'
            });
        } else {
            btnvar1.style.color = "red"
            $.ajax({
                type: 'GET',
                url: "{{url_for("like")}}",
                data: {'data': JSON.stringify(intValue)},
                contentType: "application/json",
                dataType: 'json'
            });
        }
    }


        function ShowMessage() {
       alert("you need to be logged in to like an article");

    }





</script>
<br>
{% endif %}
{% endfor %}

{% endblock %}


</body>
</html>